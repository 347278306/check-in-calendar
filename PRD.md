# 打卡日历产品需求文档

## 1 项目概述

### 1.1 项目背景

在日常生活中，人们常常需要养成良好的习惯，如每日阅读、健身、背单词等。然而，由于缺乏有效的追踪和提醒机制，许多人在坚持一段时间后容易放弃。一个直观、易用的打卡日历应用可以帮助用户记录每日习惯的完成情况，通过可视化的日历视图展示打卡历程，激励用户持续坚持下去。

本项目旨在开发一款轻量级的打卡日历应用，支持用户创建多个习惯打卡日历，每个日历可以独立追踪和展示打卡记录。用户可以在完成每日任务后进行打卡，并记录打卡的具体内容，包括文字说明和图片附件。应用采用本地存储方式，无需用户注册登录，打开即可使用。

### 1.2 项目目标

本项目的主要目标是构建一个简洁、现代的跨平台打卡日历应用，让用户能够轻松管理多个习惯的打卡记录。核心目标包括：提供直观的日历视图展示打卡情况，让用户一目了然地看到自己的打卡历程；支持多种打卡内容的记录，包括纯文字、图片以及文字加图片的组合；实现打卡数据的本地持久化存储，确保数据安全且访问快速；提供响应式的用户界面，适配桌面端和移动端的浏览需求。

### 1.3 产品愿景

成为用户养成习惯道路上的得力助手，通过简洁的设计和流畅的体验，帮助用户建立并维持良好的生活习惯。应用强调极简主义哲学，让用户专注于打卡本身，而非复杂的功能操作。

---

## 2 功能需求

### 2.1 打卡日历管理

#### 2.1.1 创建打卡日历

用户可以创建新的打卡日历，每个打卡日历代表一个需要持续养成的习惯。创建时需要填写以下信息：日历名称（必填），例如「每日读书」、「健身打卡」等，建议长度不超过20个字符；日历图标（可选），用户可以从预设的图标库中选择一个与习惯匹配的图标，也可以自定义上传图标；日历颜色（可选），用户可以为每个日历指定一个主题颜色，该颜色将贯穿整个日历的视觉展示；习惯说明（可选），简要描述该习惯的具体要求或目标，如「每天阅读至少30分钟」。

系统应对日历名称进行校验，确保不重复且符合命名规范。每个用户最多可创建50个打卡日历，以满足大多数用户的习惯追踪需求。

#### 2.1.2 编辑打卡日历

用户可以对已创建的打卡日历进行编辑修改。可编辑的内容包括日历名称、日历图标、日历颜色以及习惯说明。编辑功能应提供便捷的入口，用户可以在日历列表或日历详情页面进入编辑模式。

#### 2.1.3 删除打卡日历

用户可以删除不再需要的打卡日历。考虑到数据安全，删除操作应包含确认机制，以防止误删。删除后，该日历及其所有打卡记录将被移除，无法恢复。如果用户只是想暂时停止追踪某个习惯，可以考虑提供归档功能而非直接删除。

#### 2.1.4 日历列表管理

在应用首页展示用户所有打卡日历的列表。列表应以卡片形式呈现，每个卡片显示日历名称、图标、当日打卡状态、本周打卡统计等信息。用户可以通过上下滑动或在日历间左右滑动来浏览多个日历。列表应支持按创建时间、最近打卡时间或名称字母顺序排序。

### 2.2 每日打卡功能

#### 2.2.1 打卡操作

用户在完成当日的习惯任务后，可以进行打卡操作。打卡操作应简单直观，可以通过点击日历上的日期格子完成。对于当日及之前的日期，用户可以进行打卡；对于未来的日期，系统应提示无法提前打卡。

每次打卡成功后，应用应给予积极的视觉反馈，如打勾动画、成就音效（可选配）等。同一日历的同一日期只能打卡一次，如需修改打卡内容，应通过编辑打卡记录的方式进行。

#### 2.2.2 补打卡功能

对于忘记打卡的日子，用户可以在事后进行补打卡。补打卡时可以选择具体的日期，系统应清晰标识这是补打卡操作。考虑到习惯养成的连续性，可以考虑提供连续补打卡的功能，让用户可以一次性补上多天的打卡记录。补打卡应有合理的限制，例如只能补打卡最近30天内的记录，以避免数据混乱。

#### 2.2.3 取消打卡

如果用户误操作或需要撤销某次打卡，可以取消该日的打卡记录。取消后，该日期恢复为未打卡状态，打卡详情一并清除。取消操作同样需要二次确认。

### 2.3 打卡详情记录

#### 2.3.1 文字记录

用户在打卡时可以添加文字说明，记录当日的完成情况或心得体会。文字记录支持多行输入，没有严格的字数限制，但建议控制在500字以内以保证性能。文字内容应支持基本的格式化，如换行符的保留。保存后，用户可以随时查看和编辑这些文字记录。

#### 2.3.2 图片记录

用户可以上传图片来丰富打卡记录的内容。图片可以用于记录健身动作、阅读的书籍、运动轨迹截图等场景。图片上传支持以下功能：从相册选择已有图片；拍照直接上传；支持多图上传，每个打卡记录最多可附加9张图片；图片应进行压缩处理，以节省存储空间并加快加载速度；支持图片预览和放大查看。

#### 2.3.3 打卡时间戳

每次打卡时，系统自动记录打卡的具体时间。在打卡详情页面展示「打卡时间：2024年1月15日 08:30」这样的信息。如果进行了补打卡，还应区分首次打卡时间和补打卡时间。

#### 2.3.4 查看打卡详情

用户可以点击日历上的已打卡日期，查看该日的打卡详情。详情页面展示：打卡日期、打卡时间、文字内容、附加的所有图片（支持幻灯片式浏览）、所属的打卡日历名称。如果该日有多条打卡记录（来自不同的日历），应支持在多个记录间切换查看。

### 2.4 数据统计与展示

#### 2.4.1 日历视图

核心展示方式采用日历网格视图，月度模式下展示当前月份的日历，每天为一个格子。已打卡的日期应有明显的视觉标识，如绿色填充、打勾图标等；未打卡的日期显示为灰色或空心；今日格子应有特殊标识，如加粗边框或高亮背景。用户可以切换月份浏览，也可以快速跳转到今日。

#### 2.4.2 连续打卡统计

在日历卡片上展示当前连续打卡天数。最长连续打卡天数的记录也应展示，以激励用户突破自己的记录。连续打卡中断时，计数器应归零重新开始。

#### 2.4.3 打卡完成率

提供周打卡完成率和月打卡完成率的统计展示。完成率的计算方式为：实际打卡天数除以应打卡天数。不同的日历可以根据用户的设置有不同的打卡频率需求，如每日打卡、每周打卡3次等。

#### 2.4.4 打卡通览

提供一个打卡通览页面或功能，展示用户所有打卡记录的汇总视图。用户可以按日历筛选、按日期排序，快速定位某天的打卡情况。该视图应类似社交媒体的时间线形式，方便用户回顾自己的习惯养成历程。

---

## 3 非功能需求

### 3.1 性能需求

页面加载时间应控制在2秒以内，即使是首次加载大量数据的场景。打卡操作后数据应在100毫秒内完成保存并更新界面。日历渲染应流畅，月份切换时不应出现明显的卡顿。图片加载应采用懒加载策略，优先加载可视区域内的图片。应用应做好性能优化，避免内存泄漏，长时间使用后不应出现明显的性能下降。

### 3.2 存储需求

采用浏览器本地存储（LocalStorage或IndexedDB）作为主要存储方式。单个用户的数据存储空间建议控制在100MB以内，超出时提醒用户清理或导出。图片应进行压缩存储，原始图片可在需要时重新上传。提供数据导出和导入功能，方便用户在更换设备时迁移数据。数据格式应采用标准格式（如JSON），便于后续可能的云端同步扩展。

### 3.3 兼容性需求

Web端应支持主流浏览器的最新两个主要版本，包括Chrome、Firefox、Safari和Edge。移动端应适配响应式设计，在手机浏览器和平板浏览器上均有良好的展示效果。关键功能在弱网或离线环境下应仍能正常工作（本地存储特性天然支持）。界面应适配不同尺寸的屏幕，从手机（320px宽度）到桌面端（1920px宽度）均有良好体验。

### 3.4 安全需求

本地存储的数据应进行适当的混淆或加密，防止用户误删或恶意篡改后无法恢复。图片上传时应进行基本的格式校验和大小限制，防止恶意文件上传。提供数据备份建议，引导用户定期导出数据。应用前端代码应做好基本的防护，避免敏感信息泄露。

---

## 4 用户界面设计

### 4.1 设计原则

整体设计遵循简洁现代的风格，采用大量的留白和清晰的层级关系。配色以白色或浅灰色为背景，搭配少量的主题色点缀，保持视觉的清爽感。交互设计追求简单直观，核心操作（打卡）应在两步以内完成。动画效果适度使用，提供反馈但不过度干扰用户。

### 4.2 主要页面

#### 4.2.1 首页（日历列表）

页面顶部展示应用名称和可能的快捷操作按钮。主区域以横向或纵向的卡片列表形式展示各个打卡日历。日历卡片包含日历名称和图标、当前连续打卡天数、今日打卡状态（已打卡或未打卡）、本周完成率进度条。页面底部或悬浮按钮提供「新增日历」的入口。向上滑动可查看更多日历列表。

#### 4.2.2 日历详情页

点击日历卡片后进入该日历的详情页。页面顶部展示日历名称、图标、颜色标识以及返回按钮。主体部分为月度日历视图，支持左右滑动切换月份。点击具体日期可查看该日期的打卡详情或进行打卡操作。日历下方展示统计数据区域，包括连续打卡天数、总打卡天数、本月完成率等。提供编辑日历和删除日历的入口。

#### 4.2.3 打卡弹窗/页面

用户点击某日期后弹出打卡界面。打卡界面包含日期标识、文字输入框（支持多行）、图片上传区域（可添加多张图片）、取消和确认按钮。已打过卡的日期打开时展示已有内容，用户可以编辑更新。图片上传区域支持预览已选择的图片，点击可查看大图或删除。

#### 4.2.4 新建/编辑日历弹窗

包含日历名称输入框、图标选择器（网格形式展示预设图标）、颜色选择器（预设几种颜色供选择）、习惯说明输入框。底部提供取消和保存按钮。编辑模式下，预设值为该日历当前的数据。

### 4.3 视觉规范

主色调采用中性色（如深灰色）作为文字颜色，浅灰色作为背景色和边框色。每个日历卡片可使用用户自定义的主题色进行点缀。成功状态（如已打卡）使用绿色系，警告状态（如连续打卡可能中断）可使用橙色系。图标采用线性风格，保持统一的设计语言。字体使用系统默认字体，中文推荐使用苹方、思源黑体或微软雅黑。

---

## 5 数据模型设计

### 5.1 打卡日历（CheckInCalendar）

打卡日历实体包含以下主要字段：唯一标识符（id），用于唯一标识每个日历，采用UUID或自增数字；日历名称（name），字符串类型，存储用户为日历命名的名称；图标（icon），字符串类型，存储选择的图标标识或图标图片的存储路径；颜色（color），字符串类型，存储十六进制颜色值，如「#FF6B6B」；习惯说明（description），字符串类型，可选的文字描述该习惯的具体要求；创建时间（createdAt），时间戳类型，记录日历的创建时间；更新时间（updatedAt），时间戳类型，记录最后修改时间。

### 5.2 打卡记录（CheckInRecord）

打卡记录实体包含以下主要字段：唯一标识符（id），用于唯一标识每条打卡记录；所属日历ID（calendarId），外键关联到打卡日历；打卡日期（date），日期类型，格式为YYYY-MM-DD，记录是哪一天的打卡；打卡时间（checkInTime），时间戳类型，记录用户进行打卡操作的具体时间；打卡内容（content），字符串类型，存储用户填写的文字说明；图片列表（images），数组类型，存储该打卡记录附加的图片路径列表；是否为补打卡（isRetroactive），布尔类型，区分正常打卡和补打卡；补打卡时间（retroactiveTime），时间戳类型，如果isRetroactive为true，记录实际补打卡的时间。

### 5.3 用户设置（UserSettings）

用户设置实体包含以下主要字段：唯一标识符（id），固定为单一用户记录；主题偏好（theme），字符串类型，记录用户偏好的界面主题；周起始日（weekStartDay），数字类型，1表示周一，0表示周日；默认提醒时间（reminderTime），时间类型（可选功能），设置每日的打卡提醒时间；数据版本（version），用于数据迁移和版本控制。

### 5.4 存储结构示例

```json
{
  "calendars": [
    {
      "id": "calendar_001",
      "name": "每日读书",
      "icon": "book",
      "color": "#4A90D9",
      "description": "每天阅读至少30分钟",
      "createdAt": 1704067200000,
      "updatedAt": 1704067200000
    }
  ],
  "records": [
    {
      "id": "record_001",
      "calendarId": "calendar_001",
      "date": "2024-01-15",
      "checkInTime": 1705276800000,
      "content": "今天读了《原子习惯》，学到了习惯养成的四个定律。",
      "images": [
        "/storage/images/book_note_001.jpg",
        "/storage/images/book_cover_001.jpg"
      ],
      "isRetroactive": false
    }
  ],
  "settings": {
    "id": "user_settings_001",
    "theme": "light",
    "weekStartDay": 1,
    "version": 1
  }
}
```

---

## 6 技术选型建议

### 6.1 前端框架

推荐使用Vue.js 3或React 18作为主要的前端框架。两者都有成熟的生态系统和丰富的组件库可供选择。Vue 3的组合式API和React的Hooks都能很好地支持组件的逻辑复用。如果选择Vue 3，可以配合Vite作为构建工具，获得极快的开发服务器启动速度和热更新体验；如果选择React，可以配合Next.js或Vite实现相同效果。

UI组件库推荐使用Element Plus（Vue）或Ant Design（React），这两个组件库都提供了丰富的组件，且设计风格偏向简洁现代。如果希望更轻量级，也可以考虑Tailwind CSS配合Headless UI实现自定义的界面设计。

### 6.2 状态管理与数据存储

状态管理方面，Pinia（Vue）或Zustand（React）都是轻量级且易用的选择。对于本应用的复杂度，使用简单的React Context或Vue Provide/Inject可能已经足够，但为了代码的可维护性，建议引入专门的状态管理库。

本地数据存储采用浏览器LocalStorage和IndexedDB相结合的方式。简单的配置数据（如用户设置）存储在LocalStorage中；打卡记录和图片等较大的数据存储在IndexedDB中。可以使用Dexie.js作为IndexedDB的操作封装库，提供更便捷的API。

图片存储需要对图片进行压缩后存储在IndexedDB或转换为Base64格式存储在LocalStorage中。建议设置图片最大尺寸（如1920px）和质量压缩比例（如80%），以控制存储空间占用。

### 6.3 日历组件

日历功能是本应用的核心，可以考虑使用成熟的日历组件库，如FullCalendar（功能强大但可能较重）或vue-cal、react-calendar等轻量级选择。如果时间允许，也可以基于需求自行实现日历网格组件，以获得最大的定制灵活性。

### 6.4 构建与部署

使用Vite作为构建工具，输出静态资源文件。部署时可以部署到GitHub Pages、Vercel、Netlify或阿里云OSS等静态托管服务，实现零运维成本的公网访问。

### 6.5 推荐技术栈组合

综合以上分析，推荐以下技术栈组合作为项目的技术选型：

- 前端框架：Vue 3 + TypeScript
- 构建工具：Vite
- 状态管理：Pinia
- UI组件库：Element Plus或Tailwind CSS
- 本地存储：IndexedDB（通过Dexie.js操作）
- 日历组件：vue-cal或自行实现
- 部署方式：Vercel或GitHub Pages

---

## 7 项目里程碑

### 阶段一：基础功能实现

完成首页日历列表的展示、新增打卡日历功能、日历详情页的日历网格展示、基础的打卡操作（无图片）、打卡详情的文字展示。本阶段结束时，用户可以创建多个日历并进行基础的每日打卡和查看。

### 阶段二：内容增强与优化

实现打卡时的图片上传功能、打卡详情的图片展示与浏览、编辑和删除日历的功能、补打卡功能、数据统计展示（连续天数、完成率等）。本阶段结束时，应用具备完整的功能可用性。

### 阶段三：体验打磨

进行响应式布局适配优化、动画效果增强、数据导出与导入功能、性能优化与代码重构、浏览器兼容性测试。本阶段结束时，应用达到可发布状态。

---

## 8 风险识别与应对

### 8.1 存储空间限制

浏览器的本地存储存在容量限制，特别是LocalStorage通常限制在5MB左右。应对策略是使用IndexedDB存储图片等大数据，IndexedDB的容量通常在设备可用空间的50%左右，远大于LocalStorage。同时应对图片进行压缩处理，并设置合理的存储上限提醒。

### 8.2 数据丢失风险

由于数据存储在本地，如果用户清除浏览器缓存或更换设备，数据将丢失。应对策略是提供数据导出功能，鼓励用户定期备份数据；考虑在未来版本中提供可选的云端同步功能。

### 8.3 跨设备同步缺失

当前设计不支持多设备数据同步，可能造成用户体验上的不足。应对策略是在产品定位上明确「本地使用」的特性；如果未来需要同步功能，可以在现有架构基础上扩展云端存储支持。

---

## 9 附录

### 9.1 术语表

本需求文档中涉及的专业术语定义如下：打卡指用户标记某日任务已完成的行为；日历格子指日历网格中的每一天对应的单元格；补打卡指在错过打卡日期后进行的补录打卡操作；连续打卡指不间断的每日打卡记录。

### 9.2 参考产品

开发过程中可参考以下类似产品以获取设计灵感：小日常、Habitica、Loop Habit Tracker、Fabulous。这些产品的功能设计和界面风格可作为本项目设计决策的参考。

---

*文档版本：1.0*
*创建日期：2024年*
